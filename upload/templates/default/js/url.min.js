/*!
 * Lightweight URL manipulation with JavaScript
 * This library is independent of any other libraries and has pretty simple interface
 * and lightweight code-base.
 * Some ideas of query string parsing had been taken from Jan Wolter
 * @see http://unixpapa.com/js/querystring.html
 * @url https://github.com/Mikhus/jsurl
 * 
 * @license MIT
 * @author Mykhailo Stadnyk <mikhus@gmail.com>
 */
var Url=function(){"use strict";var a={protocol:"protocol",host:"hostname",port:"port",path:"pathname",query:"search",hash:"hash"},b={ftp:21,gopher:70,http:80,https:443,ws:80,wss:443},c=function(c,d){var f=document,g=f.createElement("a"),d=d||f.location.href,h=d.match(/\/\/(.*?)(?::(.*?))?@/)||[];g.href=d;for(var i in a)c[i]=g[a[i]]||"";if(c.protocol=c.protocol.replace(/:$/,""),c.query=c.query.replace(/^\?/,""),c.hash=c.hash.replace(/^#/,""),c.user=h[1]||"",c.pass=h[2]||"",c.port=b[c.protocol]==c.port||0==c.port?"":c.port,c.protocol||/^([a-z]+:)?\/\//.test(d))c.path=c.path.replace(/^\/?/,"/");else{var j=new Url(f.location.href.match(/(.*\/)/)[0]),k=j.path.split("/"),l=c.path.split("/");k.pop();for(var i=0,m=["protocol","user","pass","host","port"],n=m.length;n>i;i++)c[m[i]]=j[m[i]];for(;".."==l[0];)k.pop(),l.shift();c.path=("/"!=d.substring(0,1)?k.join("/"):"")+"/"+l.join("/")}e(c)},d=function(a){return a=a.replace(/\+/g," "),a=a.replace(/%([ef][0-9a-f])%([89ab][0-9a-f])%([89ab][0-9a-f])/gi,function(a,b,c,d){var e=parseInt(b,16)-224,f=parseInt(c,16)-128;if(0==e&&32>f)return a;var g=parseInt(d,16)-128,h=(e<<12)+(f<<6)+g;return h>65535?a:String.fromCharCode(h)}),a=a.replace(/%([cd][0-9a-f])%([89ab][0-9a-f])/gi,function(a,b,c){var d=parseInt(b,16)-192;if(2>d)return a;var e=parseInt(c,16)-128;return String.fromCharCode((d<<6)+e)}),a=a.replace(/%([0-7][0-9a-f])/gi,function(a,b){return String.fromCharCode(parseInt(b,16))})},e=function(a){var b=a.query;a.query=new function(a){for(var c,b=/([^=&]+)(=([^&]*))?/g;c=b.exec(a);){var e=decodeURIComponent(c[1].replace(/\+/g," ")),f=c[3]?d(c[3]):"";null!=this[e]?(this[e]instanceof Array||(this[e]=[this[e]]),this[e].push(f)):this[e]=f}this.clear=function(){for(e in this)this[e]instanceof Function||delete this[e]},this.toString=function(){var a="",b=encodeURIComponent;for(var c in this)if(!(this[c]instanceof Function))if(this[c]instanceof Array){var d=this[c].length;if(d)for(var e=0;d>e;e++)a+=a?"&":"",a+=b(c)+"="+b(this[c][e]);else a+=(a?"&":"")+b(c)+"="}else a+=a?"&":"",a+=b(c)+"="+b(this[c]);return a}}(b)};return function(a){this.toString=function(){return(this.protocol&&this.protocol+"://")+(this.user&&this.user+(this.pass&&":"+this.pass)+"@")+(this.host&&this.host)+(this.port&&":"+this.port)+(this.path&&this.path)+(this.query.toString()&&"?"+this.query)+(this.hash&&"#"+this.hash)},c(this,a)}}();
